cmake_minimum_required(VERSION 3.12)

project ({{ PROJECTNAME }}
  VERSION 1.0.0
  LANGUAGES Fortran)

# Enable CTest
enable_testing()

# This assumes that you've already cloned the pFUnit source code, built and installed it (make install)
# to a suitable location on your computer. Adding search paths using the PATHS argument is often necessary.
# See https://cmake.org/cmake/help/v3.0/command/find_package.html for more information.
# Note that the pFUnit package will be OS, compiler and compiler version dependent as it distributes Fortran mod-files.
find_package(PFUNIT REQUIRED)

# system under test source files
{% for SUTNAME, SUTFILENAME in SUTS | items %}
add_library({{ SUTNAME }}
  {{ SUTFILENAME }}
  )
{% endfor %}


{% for SUTNAME in SUTNAMES %}
target_include_directories({{ SUTNAME }} PUBLIC ${CMAKE_CURRENT_BINARY_DIR})
{% endfor %}

set_target_properties ({{ SUTNAMES|join(' ') }} PROPERTIES
  Fortran_MODULE_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})

add_subdirectory({{ TESTFOLDER }})
